!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("gantt",[],n):"object"==typeof exports?exports.gantt=n():t.gantt=n()}(this,function(){return function(t){function n(r){if(e[r])return e[r].exports;var a=e[r]={exports:{},id:r,loaded:!1};return t[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}var e={};return n.m=t,n.c=e,n.p="",n(0)}([function(t,n,e){"use strict";function r(t,n,e){function r(){o(),i(),s(),d(),l()}function o(){var t={},e=[];n.map(function(t){t&&(t.id=t.id.toString(),e.push(t.id))}),n.map(function(n){if(n){if(n.developer=n.developer||n.performer_user,n.manager=n.manager||n.creator_user,n.status=p.hasOwnProperty(n.status)?p[n.status]:n.status,n.name=n.title,n.progress=n.progress||0,n.parent_id){var r=n.parent_id.toString();e.indexOf(r)>-1&&(n.dependencies=r)}var a=n.start_time||n.created_at;if(n.start=moment(a),n.end=moment(n.deadline),n.end<n.start){var o=moment(n.created_at);n.start_time&&n.end>o?n.start=o:(delete n.start,delete n.end,n.error="Срок окончания задачи раньше чем срок начала выполнения.")}n.developer?(t.hasOwnProperty(n.developer)||(t[n.developer]=[]),t[n.developer].push(n),delete n.developer):(t.hasOwnProperty("Без разработчика")||(t["Без разработчика"]=[]),t["Без разработчика"].push(n))}}),n.length=0;for(var r in t)n.push({developer:r,header:1}),n=n.concat(t[r])}function i(){var n='<div style="float: left"><svg id="legend" width="200" height="200"></svg></div>';n+='<div style="overflow: scroll"><svg id="gantt" width="200" height="200"></svg></div>',document.getElementById(t).innerHTML=n}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Day";e||(e={}),e.view_mode=t,f.gannt=a("#gantt",n,e)}function d(){f.canvas=Snap("#legend"),f.bg=f.canvas.group(),f.grids=f.canvas.group(),f.headers=f.canvas.group(),f.projects=f.canvas.group(),f.managers=f.canvas.group(),f.status=f.canvas.group(),f.time=f.canvas.group(),f.fact=f.canvas.group(),f.error=f.canvas.group(),f.url=f.canvas.group();var t=10,e=t+u[0],r=e+u[1],a=r+u[2],o=a+u[3],i=o+u[4],s=i+u[5]-10;n.map(function(n,d){var l=83+38*d,p=l-24;if(d%2&&f.canvas.rect(5,p,s,38).addClass("bg_row").appendTo(f.grids),n.developer)f.canvas.rect(5,p,s,38).addClass("bg_header").appendTo(f.headers),f.canvas.text(t,l,c(n.developer,1,s)).addClass("developer").appendTo(f.developer);else{var h=g.hasOwnProperty(n.priority)?g[n.priority]:"normal",v=f.canvas.circle(t+u[0]/2-5,l-5,11).addClass(h).appendTo(f.url),A="http://troppus.itech-group.ru/tickets/".concat(n.id);v.node.addEventListener("click",function(t){window.open(A,"_blank")},!1)}if(n.project&&f.canvas.text(e,l,c(n.project,0,u[1])).addClass("label").appendTo(f.projects),n.manager&&f.canvas.text(r,l,c(n.manager,0,u[2])).addClass("label").appendTo(f.managers),n.status&&f.canvas.text(a,l,c(n.status,0,u[3])).addClass("label").appendTo(f.status),n.time){var _=moment({hours:0,minutes:0}).add(n.time,"minutes").format("HH:mm");n.time>1440&&(_=Math.floor(n.time/1440).toString().concat(" ",_)),f.canvas.text(o,l,c(_,0,u[4])).addClass("label").appendTo(f.time)}if(n.spent_time){var m=moment({hours:0,minutes:0}).add(n.spent_time,"minutes").format("HH:mm");n.spent_time>1440&&(m=Math.floor(n.time/1440).toString().concat(" ",m)),f.canvas.text(i,l,c(m,0,u[5])).addClass("label").appendTo(f.fact)}if(n.error){var b=f.canvas.rect(5,p,s,38).addClass("error").appendTo(f.error);b.node.addEventListener("click",function(t){alert(n.error)},!1)}}),f.canvas.text(-5+t+u[0]/2,50,c("URL",1,u[0])).addClass("header").appendTo(f.projects),f.canvas.text(-5+e+u[1]/2,50,c("Проект",1,u[1])).addClass("header").appendTo(f.projects),f.canvas.text(-5+r+u[2]/2,50,c("Менеджер",1,u[2])).addClass("header").appendTo(f.managers),f.canvas.text(-5+a+u[3]/2,50,c("Статус",1,u[3])).addClass("header").appendTo(f.status),f.canvas.text(-5+o+u[4]/2,50,c("Оценка",1,u[4])).addClass("header").appendTo(f.time),f.canvas.text(-5+i+u[5]/2,50,c("Факт",1,u[5])).addClass("header").appendTo(f.fact);var d=f.gannt.canvas.node.clientHeight||f.gannt.canvas.node.parentNode.clientHeight;f.canvas.rect(0,0,s+10,d).addClass("bg").appendTo(f.bg),f.canvas.line(e-5,32,e-5,d-20).addClass("grid").appendTo(f.grids),f.canvas.line(r-5,32,r-5,d-20).addClass("grid").appendTo(f.grids),f.canvas.line(a-5,32,a-5,d-20).addClass("grid").appendTo(f.grids),f.canvas.line(o-5,32,o-5,d-20).addClass("grid").appendTo(f.grids),f.canvas.line(i-5,32,i-5,d-20).addClass("grid").appendTo(f.grids),f.canvas.attr({height:d,width:s+15})}function c(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,r=document.createElement("canvas").getContext("2d");r.font=n?"bold 14px sans-serif":"normal 12px sans-serif";var a=r.measureText(t).width,o="…",i=r.measureText(o).width;if(e-=10,!(a<=e||a<=i)){for(var s=t.length;a>=e-i&&s-- >0;)t=t.substring(0,s),a=r.measureText(t).width;return t+o}return t}function l(){f.btns=f.canvas.group();var t=u[0]+u[1]+u[2]+u[3]+u[4]+u[5],n=(t-300)/2,e=["Day","Week","Month"];f.canvas.rect(5,5,t,24).addClass("bg_header").appendTo(f.btns),e.map(function(t,e){f.canvas.text(n+55+100*e,21,t).addClass("menu").appendTo(f.btns);var r=f.canvas.rect(n+7+100*e,7,96,20).addClass(e?"timebtn":"timebtn activebtn").appendTo(f.btns);r.node.addEventListener("click",function(n){f.canvas.selectAll(".activebtn").forEach(function(t){t.removeClass("activebtn")}),r.addClass("activebtn"),s(t)},!1)})}var f={},u=[40,130,100,65,65,65],p={0:"беклог",1:"оценка",2:"ожидает",3:"оценено",4:"план",5:"в работе",6:"проверка",7:"закрыто",8:"в архиве"},g={low:"low",normal:"normal",high:"high"};return r(),f}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=r,e(1);var a=e(5);t.exports=n["default"]},function(t,n,e){var r=e(2);"string"==typeof r&&(r=[[t.id,r,""]]);e(4)(r,{});r.locals&&(t.exports=r.locals)},function(t,n,e){n=t.exports=e(3)(),n.push([t.id,".header{text-anchor:middle;overflow:hidden}.developer,.header{font-size:14px;font-weight:700;font-family:sans-serif}.developer{fill:#fff}.label{font-weight:400;overflow:hidden}.label,.menu{font-size:12px;font-family:sans-serif}.menu{text-anchor:middle;font-weight:700}.grid{stroke:#e0e0e0;stroke-width:.4;fill:transparent}.bg{fill:#fff}.bg_row{fill:#f5f5f5}.bg_header{fill:#a3a3ff}.timebtn{stroke:#e0e0e0;stroke-width:.4;fill:transparent;cursor:pointer}.activebtn{fill:#fff;opacity:.5;cursor:auto}.error{fill:red;opacity:.5;cursor:pointer}.low{fill:#ffc}.low,.normal{stroke:#000;stroke-width:.5;cursor:pointer}.normal{fill:#5cb85c}.high{fill:#d9534f;stroke:#000;stroke-width:.5;cursor:pointer}","",{version:3,sources:["/Users/cm/Projects/gantt/src/src/styles.scss"],names:[],mappings:"AAAA,QACC,mBACA,AAEA,eACA,CACA,mBAJA,eACA,gBACA,AACA,sBAAuB,CAOvB,AANA,WAKA,SAAa,CACb,OAGA,gBACA,eACA,CACA,aAJA,eACA,AAEA,sBAAuB,CAOvB,AANA,MAEA,mBACA,AACA,eACA,CACA,MAEA,eACA,gBACA,gBAAiB,CACjB,IAEA,SAAa,CACb,QAEA,YAAa,CACb,WAEA,YAAa,CACb,SAEA,eACA,gBACA,iBACA,cAAe,CACf,WAEA,UACA,WACA,WAAY,CACZ,OAEA,SACA,WACA,cAAe,CACf,KAEA,SACA,CAGA,aAHA,YACA,gBACA,cAAe,CAOf,AANA,QAEA,YACA,CAGA,MAEA,aACA,YACA,gBACA,cAAe,CACf",file:"styles.scss",sourcesContent:[".header {\n\ttext-anchor: middle;\n\tfont-size: 14px;\n\tfont-weight: bold;\n\toverflow: hidden;\n\tfont-family: sans-serif;\n}\n.developer {\n\tfont-size: 14px;\n\tfont-weight: bold;\n\tfont-family: sans-serif;\n\tfill: #ffffff;\n}\n.label {\n\tfont-size: 12px;\n\tfont-weight: normal;\n\toverflow: hidden;\n\tfont-family: sans-serif;\n}\n.menu {\n\ttext-anchor: middle;\n\tfont-size: 12px;\n\tfont-weight: bold;\n\tfont-family: sans-serif;\n}\n.grid {\n\tstroke: #e0e0e0;\n\tstroke-width: 0.4;\n\tfill: transparent;\n}\n.bg {\n\tfill: #ffffff;\n}\n.bg_row {\n\tfill: #f5f5f5;\n}\n.bg_header {\n\tfill: #a3a3ff;\n}\n.timebtn {\n\tstroke: #e0e0e0;\n\tstroke-width: 0.4;\n\tfill: transparent;\n\tcursor: pointer;\n}\n.activebtn {\n\tfill: #ffffff;\n\topacity: 0.5;\n\tcursor: auto;\n}\n.error {\n\tfill: #ff0000;\n\topacity: 0.5;\n\tcursor: pointer;\n}\n.low {\n\tfill: #ffffcc;\n\tstroke: #000000;\n\tstroke-width: 0.5;\n\tcursor: pointer;\n}\n.normal {\n\tfill: #5cb85c;\n\tstroke: #000000;\n\tstroke-width: 0.5;\n\tcursor: pointer;\n}\n.high {\n\tfill: #d9534f;\n\tstroke: #000000;\n\tstroke-width: 0.5;\n\tcursor: pointer;\n}"],sourceRoot:""}])},function(t,n){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],n=0;n<this.length;n++){var e=this[n];e[2]?t.push("@media "+e[2]+"{"+e[1]+"}"):t.push(e[1])}return t.join("")},t.i=function(n,e){"string"==typeof n&&(n=[[null,n,""]]);for(var r={},a=0;a<this.length;a++){var o=this[a][0];"number"==typeof o&&(r[o]=!0)}for(a=0;a<n.length;a++){var i=n[a];"number"==typeof i[0]&&r[i[0]]||(e&&!i[2]?i[2]=e:e&&(i[2]="("+i[2]+") and ("+e+")"),t.push(i))}},t}},function(t,n,e){function r(t,n){for(var e=0;e<t.length;e++){var r=t[e],a=p[r.id];if(a){a.refs++;for(var o=0;o<a.parts.length;o++)a.parts[o](r.parts[o]);for(;o<r.parts.length;o++)a.parts.push(c(r.parts[o],n))}else{for(var i=[],o=0;o<r.parts.length;o++)i.push(c(r.parts[o],n));p[r.id]={id:r.id,refs:1,parts:i}}}}function a(t){for(var n=[],e={},r=0;r<t.length;r++){var a=t[r],o=a[0],i=a[1],s=a[2],d=a[3],c={css:i,media:s,sourceMap:d};e[o]?e[o].parts.push(c):n.push(e[o]={id:o,parts:[c]})}return n}function o(t,n){var e=v(),r=m[m.length-1];if("top"===t.insertAt)r?r.nextSibling?e.insertBefore(n,r.nextSibling):e.appendChild(n):e.insertBefore(n,e.firstChild),m.push(n);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");e.appendChild(n)}}function i(t){t.parentNode.removeChild(t);var n=m.indexOf(t);n>=0&&m.splice(n,1)}function s(t){var n=document.createElement("style");return n.type="text/css",o(t,n),n}function d(t){var n=document.createElement("link");return n.rel="stylesheet",o(t,n),n}function c(t,n){var e,r,a;if(n.singleton){var o=_++;e=A||(A=s(n)),r=l.bind(null,e,o,!1),a=l.bind(null,e,o,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(e=d(n),r=u.bind(null,e),a=function(){i(e),e.href&&URL.revokeObjectURL(e.href)}):(e=s(n),r=f.bind(null,e),a=function(){i(e)});return r(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;r(t=n)}else a()}}function l(t,n,e,r){var a=e?"":r.css;if(t.styleSheet)t.styleSheet.cssText=b(n,a);else{var o=document.createTextNode(a),i=t.childNodes;i[n]&&t.removeChild(i[n]),i.length?t.insertBefore(o,i[n]):t.appendChild(o)}}function f(t,n){var e=n.css,r=n.media;if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}function u(t,n){var e=n.css,r=n.sourceMap;r&&(e+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var a=new Blob([e],{type:"text/css"}),o=t.href;t.href=URL.createObjectURL(a),o&&URL.revokeObjectURL(o)}var p={},g=function(t){var n;return function(){return"undefined"==typeof n&&(n=t.apply(this,arguments)),n}},h=g(function(){return/msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())}),v=g(function(){return document.head||document.getElementsByTagName("head")[0]}),A=null,_=0,m=[];t.exports=function(t,n){n=n||{},"undefined"==typeof n.singleton&&(n.singleton=h()),"undefined"==typeof n.insertAt&&(n.insertAt="bottom");var e=a(t);return r(e,n),function(t){for(var o=[],i=0;i<e.length;i++){var s=e[i],d=p[s.id];d.refs--,o.push(d)}if(t){var c=a(t);r(c,n)}for(var i=0;i<o.length;i++){var d=o[i];if(0===d.refs){for(var l=0;l<d.parts.length;l++)d.parts[l]();delete p[d.id]}}}};var b=function(){var t=[];return function(n,e){return t[n]=e,t.filter(Boolean).join("\n")}}()},function(t,n,e){!function(n,e){t.exports=e()}(this,function(){return function(t){function n(r){if(e[r])return e[r].exports;var a=e[r]={exports:{},id:r,loaded:!1};return t[r].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}var e={};return n.m=t,n.c=e,n.p="",n(0)}([function(t,n,e){"use strict";function r(t){return t&&t.__esModule?t:{"default":t}}function a(t,n,e){function r(){a(),X.change_view_mode=c,X.unselect_all=L,X.view_is=O,X.get_bar=R,X.trigger_event=F,X.refresh=s,c(X.config.view_mode)}function a(){var t={header_height:50,column_width:30,step:24,view_modes:["Quarter Day","Half Day","Day","Week","Month"],bar:{height:20},arrow:{curve:5},padding:18,view_mode:"Day",date_format:"YYYY-MM-DD",custom_popup_html:null};X.config=Object.assign({},t,e),o(n)}function o(n){X.element=t,X._tasks=n,X._bars=[],X._arrows=[],X.element_groups={}}function s(t){o(t),c(X.config.view_mode)}function c(t){b(t),l(),h(),F("view_change",[t])}function l(){f(),u(),p(),g()}function f(){X.tasks=X._tasks.map(function(t,n){if(t._start=moment(t.start,X.config.date_format),t._end=moment(t.end,X.config.date_format),t._index=n,t.start||t.end||(t._start=moment().startOf("day"),t._end=moment().startOf("day").add(2,"days")),!t.start&&t.end&&(t._start=t._end.clone().add(-2,"days")),t.start&&!t.end&&(t._end=t._start.clone().add(2,"days")),t.start&&t.end||(t.invalid=!0),"string"==typeof t.dependencies||!t.dependencies){var e=[];t.dependencies&&(e=t.dependencies.split(",").map(function(t){return t.trim()}).filter(function(t){return t})),t.dependencies=e}return t.id||(t.id=Y(t)),t})}function u(){X.dependency_map={};var t=!0,n=!1,e=void 0;try{for(var r,a=X.tasks[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var o=r.value,i=!0,s=!1,d=void 0;try{for(var c,l=o.dependencies[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var f=c.value;X.dependency_map[f]=X.dependency_map[f]||[],X.dependency_map[f].push(o.id)}}catch(u){s=!0,d=u}finally{try{!i&&l["return"]&&l["return"]()}finally{if(s)throw d}}}}catch(u){n=!0,e=u}finally{try{!t&&a["return"]&&a["return"]()}finally{if(n)throw e}}}function p(){X.gantt_start=X.gantt_end=null;var t=!0,n=!1,e=void 0;try{for(var r,a=X.tasks[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var o=r.value;(!X.gantt_start||o._start<X.gantt_start)&&(X.gantt_start=o._start),(!X.gantt_end||o._end>X.gantt_end)&&(X.gantt_end=o._end)}}catch(i){n=!0,e=i}finally{try{!t&&a["return"]&&a["return"]()}finally{if(n)throw e}}A(),_()}function g(){X.canvas||(X.canvas=Snap(X.element).addClass("gantt"))}function h(){v(),m(),C(),T(),W(),S(),H(),y(),w(),U()}function v(){X.canvas.clear(),X._bars=[],X._arrows=[]}function A(){O(["Quarter Day","Half Day"])?(X.gantt_start=X.gantt_start.clone().subtract(1,"day"),X.gantt_end=X.gantt_end.clone().add(1,"day")):O("Month")?(X.gantt_start=X.gantt_start.clone().subtract(56,"day"),X.gantt_end=X.gantt_end.clone().add(112,"day")):O("Week")?(X.gantt_start=X.gantt_start.clone().subtract(28,"day"),X.gantt_end=X.gantt_end.clone().add(56,"day")):(X.gantt_start=X.gantt_start.clone().subtract(14,"day"),X.gantt_end=X.gantt_end.clone().add(28,"day"))}function _(){X.dates=[];for(var t=null;null===t||t<X.gantt_end;)t=t?O("Month")?t.clone().add(1,"month"):t.clone().add(X.config.step,"hours"):X.gantt_start.clone(),X.dates.push(t)}function m(){var t=["grid","date","arrow","progress","bar","details"],n=!0,e=!1,r=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var i=a.value;X.element_groups[i]=X.canvas.group().attr({id:i})}}catch(s){e=!0,r=s}finally{try{!n&&o["return"]&&o["return"]()}finally{if(e)throw r}}}function b(t){X.config.view_mode=t,"Day"===t?(X.config.step=24,X.config.column_width=38):"Half Day"===t?(X.config.step=12,X.config.column_width=38):"Quarter Day"===t?(X.config.step=6,X.config.column_width=38):"Week"===t?(X.config.step=168,X.config.column_width=140):"Month"===t&&(X.config.step=720,X.config.column_width=120)}function y(){var t=X.canvas.node.getBoundingClientRect().width,n=X.canvas.select("#grid .grid-row").attr("width");t<n&&X.canvas.attr("width",n)}function w(){var t=document.querySelector(X.element).parentElement;if(t){var n=x().diff(X.gantt_start,"hours")/X.config.step*X.config.column_width-X.config.column_width;t.scrollLeft=n}}function x(){return moment()}function C(){k(),E(),B(),M(),$()}function k(){var t=X.dates.length*X.config.column_width,n=X.config.header_height+X.config.padding+(X.config.bar.height+X.config.padding)*X.tasks.length;X.canvas.rect(0,0,t,n).addClass("grid-background").appendTo(X.element_groups.grid),X.canvas.attr({height:n+X.config.padding,width:"100%"})}function B(){var t=X.dates.length*X.config.column_width,n=X.config.header_height+10;X.canvas.rect(0,0,t,n).addClass("grid-header").appendTo(X.element_groups.grid)}function E(){var t=X.canvas.group().appendTo(X.element_groups.grid),n=X.canvas.group().appendTo(X.element_groups.grid),e=X.dates.length*X.config.column_width,r=X.config.bar.height+X.config.padding,a=X.config.header_height+X.config.padding/2,o=!0,i=!1,s=void 0;try{for(var d,c=X.tasks[Symbol.iterator]();!(o=(d=c.next()).done);o=!0){d.value;X.canvas.rect(0,a,e,r).addClass("grid-row").appendTo(t),X.canvas.line(0,a+r,e,a+r).addClass("row-line").appendTo(n),a+=X.config.bar.height+X.config.padding}}catch(l){i=!0,s=l}finally{try{!o&&c["return"]&&c["return"]()}finally{if(i)throw s}}}function M(){var t=0,n=X.config.header_height+X.config.padding/2,e=(X.config.bar.height+X.config.padding)*X.tasks.length,r=!0,a=!1,o=void 0;try{for(var i,s=X.dates[Symbol.iterator]();!(r=(i=s.next()).done);r=!0){var d=i.value,c="tick";O("Day")&&1===d.day()&&(c+=" thick"),O("Week")&&d.date()>=1&&d.date()<8&&(c+=" thick"),O("Month")&&d.month()%3===0&&(c+=" thick"),X.canvas.path(Snap.format("M {x} {y} v {height}",{x:t,y:n,height:e})).addClass(c).appendTo(X.element_groups.grid),t+=O("Month")?d.daysInMonth()*X.config.column_width/30:X.config.column_width}}catch(l){a=!0,o=l}finally{try{!r&&s["return"]&&s["return"]()}finally{if(a)throw o}}}function $(){if(O("Day")){var t=moment().startOf("day").diff(X.gantt_start,"hours")/X.config.step*X.config.column_width,n=0,e=X.config.column_width,r=(X.config.bar.height+X.config.padding)*X.tasks.length+X.config.header_height+X.config.padding/2;X.canvas.rect(t,n,e,r).addClass("today-highlight").appendTo(X.element_groups.grid)}}function T(){var t=!0,n=!1,e=void 0;try{for(var r,a=D()[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var o=r.value;if(X.canvas.text(o.lower_x,o.lower_y,o.lower_text).addClass("lower-text").appendTo(X.element_groups.date),o.upper_text){var i=X.canvas.text(o.upper_x,o.upper_y,o.upper_text).addClass("upper-text").appendTo(X.element_groups.date);i.getBBox().x2>X.element_groups.grid.getBBox().width&&i.remove()}}}catch(s){n=!0,e=s}finally{try{!t&&a["return"]&&a["return"]()}finally{if(n)throw e}}}function D(){var t=null,n=X.dates.map(function(n,e){var r=j(n,t,e);return t=n,r});return n}function j(t,n,e){n||(n=t.clone().add(1,"year"));var r={"Quarter Day_lower":t.format("HH"),"Half Day_lower":t.format("HH"),Day_lower:t.date()!==n.date()?t.format("D"):"",Week_lower:t.month()!==n.month()?t.format("D MMM"):t.format("D"),Month_lower:t.format("MMMM"),"Quarter Day_upper":t.date()!==n.date()?t.format("D MMM"):"","Half Day_upper":t.date()!==n.date()?t.month()!==n.month()?t.format("D MMM"):t.format("D"):"",Day_upper:t.month()!==n.month()?t.format("MMMM"):"",Week_upper:t.month()!==n.month()?t.format("MMMM"):"",Month_upper:t.year()!==n.year()?t.format("YYYY"):""},a={x:e*X.config.column_width,lower_y:X.config.header_height,upper_y:X.config.header_height-25},o={"Quarter Day_lower":4*X.config.column_width/2,"Quarter Day_upper":0,"Half Day_lower":2*X.config.column_width/2,"Half Day_upper":0,Day_lower:X.config.column_width/2,Day_upper:30*X.config.column_width/2,Week_lower:0,Week_upper:4*X.config.column_width/2,Month_lower:X.config.column_width/2,Month_upper:12*X.config.column_width/2};return{upper_text:r[X.config.view_mode+"_upper"],lower_text:r[X.config.view_mode+"_lower"],upper_x:a.x+o[X.config.view_mode+"_upper"],upper_y:a.upper_y,lower_x:a.x+o[X.config.view_mode+"_lower"],lower_y:a.lower_y}}function S(){X._arrows=[];var t=!0,n=!1,e=void 0;try{for(var r,a=function(){var t=r.value,n=[];n=t.dependencies.map(function(n){var e=I(n);if(e){var r=(0,d["default"])(X,X._bars[e._index],X._bars[t._index]);return X.element_groups.arrow.add(r.element),r}}).filter(function(t){return t}),X._arrows=X._arrows.concat(n)},o=X.tasks[Symbol.iterator]();!(t=(r=o.next()).done);t=!0)a()}catch(i){n=!0,e=i}finally{try{!t&&o["return"]&&o["return"]()}finally{if(n)throw e}}}function W(){X._bars=X.tasks.map(function(t){var n=(0,i["default"])(X,t);return X.element_groups.bar.add(n.group),n})}function H(){var t=!0,n=!1,e=void 0;try{for(var r,a=function(){var t=r.value;t.arrows=X._arrows.filter(function(n){return n.from_task.task.id===t.task.id||n.to_task.task.id===t.task.id})},o=X._bars[Symbol.iterator]();!(t=(r=o.next()).done);t=!0)a()}catch(i){n=!0,e=i}finally{try{!t&&o["return"]&&o["return"]()}finally{if(n)throw e}}}function U(){X.element_groups.grid.click(function(){L(),X.element_groups.details.selectAll(".details-wrapper").forEach(function(t){return t.addClass("hide")})})}function L(){X.canvas.selectAll(".bar-wrapper").forEach(function(t){t.removeClass("active")})}function O(t){if("string"==typeof t)return X.config.view_mode===t;if(Array.isArray(t)){var n=!0,e=!1,r=void 0;try{for(var a,o=t[Symbol.iterator]();!(n=(a=o.next()).done);n=!0){var i=a.value;if(X.config.view_mode===i)return!0}}catch(s){e=!0,r=s}finally{try{!n&&o["return"]&&o["return"]()}finally{if(e)throw r}}return!1}}function I(t){return X.tasks.find(function(n){return n.id===t})}function R(t){return X._bars.find(function(n){return n.task.id===t})}function Y(t){return t.name+"_"+Math.random().toString(36).slice(2,12)}function F(t,n){X.config["on_"+t]&&X.config["on_"+t].apply(null,n)}var X={};return r(),X}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=a,e(1);var o=e(5),i=r(o),s=e(6),d=r(s);t.exports=n["default"]},function(t,n,e){var r=e(2);"string"==typeof r&&(r=[[t.id,r,""]]);e(4)(r,{});r.locals&&(t.exports=r.locals)},function(t,n,e){n=t.exports=e(3)(),n.push([t.id,".gantt .grid-background {\n  fill: none; }\n\n.gantt .grid-header {\n  fill: #ffffff;\n  stroke: #e0e0e0;\n  stroke-width: 1.4; }\n\n.gantt .grid-row {\n  fill: #ffffff; }\n\n.gantt .grid-row:nth-child(even) {\n  fill: #f5f5f5; }\n\n.gantt .row-line {\n  stroke: #ebeff2; }\n\n.gantt .tick {\n  stroke: #e0e0e0;\n  stroke-width: 0.2; }\n  .gantt .tick.thick {\n    stroke-width: 0.4; }\n\n.gantt .today-highlight {\n  fill: #fcf8e3;\n  opacity: 0.5; }\n\n.gantt #arrow {\n  fill: none;\n  stroke: #666;\n  stroke-width: 1.4; }\n\n.gantt .bar {\n  fill: #b8c2cc;\n  stroke: #8D99A6;\n  stroke-width: 0;\n  transition: stroke-width .3s ease; }\n\n.gantt .bar-progress {\n  fill: #a3a3ff; }\n\n.gantt .bar-invalid {\n  display: none; }\n\n.gantt .bar-label {\n  fill: #fff;\n  dominant-baseline: central;\n  text-anchor: middle;\n  font-size: 12px;\n  font-weight: lighter; }\n  .gantt .bar-label.big {\n    fill: #555;\n    text-anchor: start; }\n\n.gantt .handle {\n  fill: #ddd;\n  cursor: ew-resize;\n  opacity: 0;\n  visibility: hidden;\n  transition: opacity .3s ease; }\n\n.gantt .bar-wrapper {\n  cursor: pointer; }\n  .gantt .bar-wrapper:hover .bar {\n    stroke-width: 2; }\n  .gantt .bar-wrapper:hover .handle {\n    visibility: visible;\n    opacity: 1; }\n  .gantt .bar-wrapper.active .bar {\n    stroke-width: 2; }\n\n.gantt .lower-text, .gantt .upper-text {\n  font-size: 12px;\n  text-anchor: middle; }\n\n.gantt .upper-text {\n  fill: #555; }\n\n.gantt .lower-text {\n  fill: #333; }\n\n.gantt #details .details-container {\n  background: #fff;\n  display: inline-block;\n  padding: 12px; }\n  .gantt #details .details-container h5, .gantt #details .details-container p {\n    margin: 0; }\n  .gantt #details .details-container h5 {\n    font-size: 12px;\n    font-weight: bold;\n    margin-bottom: 10px;\n    color: #555; }\n  .gantt #details .details-container p {\n    font-size: 12px;\n    margin-bottom: 6px;\n    color: #666; }\n  .gantt #details .details-container p:last-child {\n    margin-bottom: 0; }\n\n.gantt .hide {\n  display: none; }\n","",{version:3,sources:["/Users/cm/Projects/frappe_gantt/src/src/gantt.scss"],names:[],mappings:"AAYA;EAGE,WAAU,EACV;;AAJF;EAME,cAAa;EACb,gBAjBoB;EAkBpB,kBAAiB,EACjB;;AATF;EAWE,cAAa,EACb;;AAZF;EAcE,cAvBgB,EAwBhB;;AAfF;EAiBE,gBAzB0B,EA0B1B;;AAlBF;EAoBE,gBA9BoB;EA+BpB,kBAAiB,EAIjB;EAzBF;IAuBG,kBAAiB,EACjB;;AAxBH;EA2BE,cAlCoB;EAmCpB,aAAY,EACZ;;AA7BF;EAgCE,WAAU;EACV,aAvCe;EAwCf,kBAAiB,EACjB;;AAnCF;EAsCE,cAlDiB;EAmDjB,gBAlDkB;EAmDlB,gBAAe;EACf,kCAAiC,EACjC;;AA1CF;EA4CE,cA/CY,EAgDZ;;AA7CF;EA+CE,cAAa,EACb;;AAhDF;EAkDE,WAAU;EACV,2BAA0B;EAC1B,oBAAmB;EACnB,gBAAe;EACf,qBAAoB,EAMpB;EA5DF;IAyDG,WA9Dc;IA+Dd,mBAAkB,EAClB;;AA3DH;EA+DE,WAjEiB;EAkEjB,kBAAiB;EACjB,WAAU;EACV,mBAAkB;EAClB,6BAA4B,EAC5B;;AApEF;EAuEE,gBAAe,EAkBf;EAzFF;IA2EI,gBAAe,EACf;EA5EJ;IA+EI,oBAAmB;IACnB,WAAU,EACV;EAjFJ;IAsFI,gBAAe,EACf;;AAvFJ;EA4FE,gBAAe;EACf,oBAAmB,EACnB;;AA9FF;EAgGE,WArGe,EAsGf;;AAjGF;EAmGE,WAvGe,EAwGf;;AApGF;EAuGE,iBAAgB;EAChB,sBAAqB;EACrB,cAAa,EAsBb;EA/HF;IA4GG,UAAS,EACT;EA7GH;IAgHG,gBAAe;IACf,kBAAiB;IACjB,oBAAmB;IACnB,YAxHc,EAyHd;EApHH;IAuHG,gBAAe;IACf,mBAAkB;IAClB,YA/Hc,EAgId;EA1HH;IA6HG,iBAAgB,EAChB;;AA9HH;EAkIE,cAAa,EACb",file:"gantt.scss",sourcesContent:["$bar-color: #b8c2cc;\n$bar-stroke: #8D99A6;\n$border-color: #e0e0e0;\n$light-bg: #f5f5f5;\n$light-border-color: #ebeff2;\n$light-yellow: #fcf8e3;\n$text-muted: #666;\n$text-light: #555;\n$text-color: #333;\n$blue: #a3a3ff;\n$handle-color: #ddd;\n\n.gantt {\n\n\t.grid-background {\n\t\tfill: none;\n\t}\n\t.grid-header {\n\t\tfill: #ffffff;\n\t\tstroke: $border-color;\n\t\tstroke-width: 1.4;\n\t}\n\t.grid-row {\n\t\tfill: #ffffff;\n\t}\n\t.grid-row:nth-child(even) {\n\t\tfill: $light-bg;\n\t}\n\t.row-line {\n\t\tstroke: $light-border-color;\n\t}\n\t.tick {\n\t\tstroke: $border-color;\n\t\tstroke-width: 0.2;\n\t\t&.thick {\n\t\t\tstroke-width: 0.4;\n\t\t}\n\t}\n\t.today-highlight {\n\t\tfill: $light-yellow;\n\t\topacity: 0.5;\n\t}\n\n\t#arrow {\n\t\tfill: none;\n\t\tstroke: $text-muted;\n\t\tstroke-width: 1.4;\n\t}\n\n\t.bar {\n\t\tfill: $bar-color;\n\t\tstroke: $bar-stroke;\n\t\tstroke-width: 0;\n\t\ttransition: stroke-width .3s ease;\n\t}\n\t.bar-progress {\n\t\tfill: $blue;\n\t}\n\t.bar-invalid {\n\t\tdisplay: none;\n\t}\n\t.bar-label {\n\t\tfill: #fff;\n\t\tdominant-baseline: central;\n\t\ttext-anchor: middle;\n\t\tfont-size: 12px;\n\t\tfont-weight: lighter;\n\n\t\t&.big {\n\t\t\tfill: $text-light;\n\t\t\ttext-anchor: start;\n\t\t}\n\t}\n\n\t.handle {\n\t\tfill: $handle-color;\n\t\tcursor: ew-resize;\n\t\topacity: 0;\n\t\tvisibility: hidden;\n\t\ttransition: opacity .3s ease;\n\t}\n\n\t.bar-wrapper {\n\t\tcursor: pointer;\n\n\t\t&:hover {\n\t\t\t.bar {\n\t\t\t\tstroke-width: 2;\n\t\t\t}\n\n\t\t\t.handle {\n\t\t\t\tvisibility: visible;\n\t\t\t\topacity: 1;\n\t\t\t}\n\t\t}\n\n\t\t&.active {\n\t\t\t.bar {\n\t\t\t\tstroke-width: 2;\n\t\t\t}\n\t\t}\n\t}\n\n\t.lower-text, .upper-text {\n\t\tfont-size: 12px;\n\t\ttext-anchor: middle;\n\t}\n\t.upper-text {\n\t\tfill: $text-light;\n\t}\n\t.lower-text {\n\t\tfill: $text-color;\n\t}\n\n\t#details .details-container {\n\t\tbackground: #fff;\n\t\tdisplay: inline-block;\n\t\tpadding: 12px;\n\n\t\th5, p {\n\t\t\tmargin: 0;\n\t\t}\n\n\t\th5 {\n\t\t\tfont-size: 12px;\n\t\t\tfont-weight: bold;\n\t\t\tmargin-bottom: 10px;\n\t\t\tcolor: $text-light;\n\t\t}\n\n\t\tp {\n\t\t\tfont-size: 12px;\n\t\t\tmargin-bottom: 6px;\n\t\t\tcolor: $text-muted;\n\t\t}\n\n\t\tp:last-child {\n\t\t\tmargin-bottom: 0;\n\t\t}\n\t}\n\n\t.hide {\n\t\tdisplay: none;\n\t}\n}\n"],sourceRoot:""}])},function(t,n){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],n=0;n<this.length;n++){var e=this[n];e[2]?t.push("@media "+e[2]+"{"+e[1]+"}"):t.push(e[1])}return t.join("")},t.i=function(n,e){"string"==typeof n&&(n=[[null,n,""]]);for(var r={},a=0;a<this.length;a++){var o=this[a][0];"number"==typeof o&&(r[o]=!0)}for(a=0;a<n.length;a++){var i=n[a];"number"==typeof i[0]&&r[i[0]]||(e&&!i[2]?i[2]=e:e&&(i[2]="("+i[2]+") and ("+e+")"),t.push(i))}},t}},function(t,n,e){function r(t,n){for(var e=0;e<t.length;e++){var r=t[e],a=p[r.id];if(a){a.refs++;for(var o=0;o<a.parts.length;o++)a.parts[o](r.parts[o]);for(;o<r.parts.length;o++)a.parts.push(c(r.parts[o],n))}else{for(var i=[],o=0;o<r.parts.length;o++)i.push(c(r.parts[o],n));p[r.id]={id:r.id,refs:1,parts:i}}}}function a(t){for(var n=[],e={},r=0;r<t.length;r++){var a=t[r],o=a[0],i=a[1],s=a[2],d=a[3],c={css:i,media:s,sourceMap:d};e[o]?e[o].parts.push(c):n.push(e[o]={id:o,parts:[c]})}return n}function o(t,n){var e=v(),r=m[m.length-1];if("top"===t.insertAt)r?r.nextSibling?e.insertBefore(n,r.nextSibling):e.appendChild(n):e.insertBefore(n,e.firstChild),m.push(n);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");e.appendChild(n)}}function i(t){t.parentNode.removeChild(t);var n=m.indexOf(t);n>=0&&m.splice(n,1)}function s(t){var n=document.createElement("style");return n.type="text/css",o(t,n),n}function d(t){var n=document.createElement("link");return n.rel="stylesheet",o(t,n),n}function c(t,n){var e,r,a;if(n.singleton){var o=_++;e=A||(A=s(n)),r=l.bind(null,e,o,!1),a=l.bind(null,e,o,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(e=d(n),r=u.bind(null,e),a=function(){i(e),e.href&&URL.revokeObjectURL(e.href)}):(e=s(n),r=f.bind(null,e),a=function(){i(e)});return r(t),function(n){if(n){if(n.css===t.css&&n.media===t.media&&n.sourceMap===t.sourceMap)return;r(t=n)}else a()}}function l(t,n,e,r){var a=e?"":r.css;if(t.styleSheet)t.styleSheet.cssText=b(n,a);else{var o=document.createTextNode(a),i=t.childNodes;i[n]&&t.removeChild(i[n]),i.length?t.insertBefore(o,i[n]):t.appendChild(o)}}function f(t,n){var e=n.css,r=n.media;if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}function u(t,n){var e=n.css,r=n.sourceMap;r&&(e+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var a=new Blob([e],{type:"text/css"}),o=t.href;t.href=URL.createObjectURL(a),o&&URL.revokeObjectURL(o)}var p={},g=function(t){var n;return function(){return"undefined"==typeof n&&(n=t.apply(this,arguments)),n}},h=g(function(){return/msie [6-9]\b/.test(self.navigator.userAgent.toLowerCase())}),v=g(function(){return document.head||document.getElementsByTagName("head")[0]}),A=null,_=0,m=[];t.exports=function(t,n){n=n||{},"undefined"==typeof n.singleton&&(n.singleton=h()),"undefined"==typeof n.insertAt&&(n.insertAt="bottom");var e=a(t);return r(e,n),function(t){for(var o=[],i=0;i<e.length;i++){var s=e[i],d=p[s.id];d.refs--,o.push(d)}if(t){var c=a(t);r(c,n)}for(var i=0;i<o.length;i++){var d=o[i];if(0===d.refs){for(var l=0;l<d.parts.length;l++)d.parts[l]();delete p[d.id]}}}};var b=function(){var t=[];return function(n,e){return t[n]=e,t.filter(Boolean).join("\n")}}()},function(t,n){"use strict";function e(t,n){function e(){r(),a(),s(),p()}function r(){P.action_completed=!1,P.task=n}function a(){o(),i()}function o(){P.invalid=P.task.invalid,P.height=t.config.bar.height,P.x=L(),P.y=O(),P.corner_radius=3,P.duration=(P.task._end.diff(P.task._start,"hours")+24)/t.config.step,P.width=t.config.column_width*P.duration,P.progress_width=t.config.column_width*P.duration*(P.task.progress/100)||0,P.group=t.canvas.group().addClass("bar-wrapper").addClass(P.task.custom_class||""),P.bar_group=t.canvas.group().addClass("bar-group").appendTo(P.group),P.handle_group=t.canvas.group().addClass("handle-group").appendTo(P.group)}function i(){Snap.plugin(function(t,n,e,r,a){n.prototype.getX=function(){return+this.attr("x")},n.prototype.getY=function(){return+this.attr("y")},n.prototype.getWidth=function(){return+this.attr("width")},n.prototype.getHeight=function(){return+this.attr("height")},n.prototype.getEndX=function(){return this.getX()+this.getWidth();
}})}function s(){d(),c(),l(),f()}function d(){P.$bar=t.canvas.rect(P.x,P.y,P.width,P.height,P.corner_radius,P.corner_radius).addClass("bar").appendTo(P.bar_group),P.invalid&&P.$bar.addClass("bar-invalid")}function c(){P.invalid||(P.$bar_progress=t.canvas.rect(P.x,P.y,P.progress_width,P.height,P.corner_radius,P.corner_radius).addClass("bar-progress").appendTo(P.bar_group))}function l(){t.canvas.text(P.x+P.width/2,P.y+P.height/2,P.task.name).addClass("bar-label").appendTo(P.bar_group),F()}function f(){if(!P.invalid){var n=P.$bar,e=8;t.canvas.rect(n.getX()+n.getWidth()-9,n.getY()+1,e,P.height-2,P.corner_radius,P.corner_radius).addClass("handle right").appendTo(P.handle_group),t.canvas.rect(n.getX()+1,n.getY()+1,e,P.height-2,P.corner_radius,P.corner_radius).addClass("handle left").appendTo(P.handle_group),P.task.progress&&P.task.progress<100&&t.canvas.polygon(u()).addClass("handle progress").appendTo(P.handle_group)}}function u(){var t=P.$bar_progress;return[t.getEndX()-5,t.getY()+t.getHeight(),t.getEndX()+5,t.getY()+t.getHeight(),t.getEndX(),t.getY()+t.getHeight()-8.66]}function p(){P.invalid||(D(),g(),_(),b(),y())}function g(){var n=t.element_groups.details;if(P.details_box=n.select(".details-wrapper[data-task='"+P.task.id+"']"),!P.details_box){P.details_box=t.canvas.group().addClass("details-wrapper hide").attr("data-task",P.task.id).appendTo(n),h();var e=t.canvas.filter(Snap.filter.shadow(0,1,1,"#666",.6));P.details_box.attr({filter:e})}P.group.click(function(t){P.action_completed||(n.selectAll(".details-wrapper").forEach(function(t){return t.addClass("hide")}),P.details_box.removeClass("hide"))})}function h(){var t=A(),n=t.x,e=t.y;P.details_box.transform("t"+n+","+e),P.details_box.clear();var r=v(),a=Snap.parse('<foreignObject width="5000" height="2000">\n\t\t\t\t<body xmlns="http://www.w3.org/1999/xhtml">\n\t\t\t\t\t'+r+"\n\t\t\t\t</body>\n\t\t\t\t</foreignObject>");P.details_box.append(a)}function v(){if(t.config.custom_popup_html){var e=t.config.custom_popup_html;if("string"==typeof e)return e;if(N(e))return e(n)}var r=P.task._start.format("MMM D"),a=P.task._end.format("MMM D"),o=P.task.name+": "+r+" - "+a,i="Duration: "+P.duration+" days",s=P.task.progress?"Progress: "+P.task.progress:null,d='\n\t\t\t<div class="details-container">\n\t\t\t\t<h5>'+o+"</h5>\n\t\t\t\t<p>"+i+"</p>\n\t\t\t\t"+(s?"<p>"+s+"</p>":"")+"\n\t\t\t</div>\n\t\t";return d}function A(){return{x:P.$bar.getEndX()+2,y:P.$bar.getY()-10}}function _(){function t(t,n){M(t,n)}function n(){$()}function e(t,n){k(t,n)}function r(){B()}var a=m(),o=a.left,i=a.right;o.drag(e,w,r),i.drag(t,w,n)}function m(){return{left:P.handle_group.select(".handle.left"),right:P.handle_group.select(".handle.right")}}function b(){P.bar_group.drag(x,w,C)}function y(){function t(t,n){t>a.max_dx&&(t=a.max_dx),t<a.min_dx&&(t=a.min_dx),a.attr("width",a.owidth+t),o.attr("points",u()),a.finaldx=t}function n(){a.finaldx&&(S(),W())}function e(){a.finaldx=0,a.owidth=a.getWidth(),a.min_dx=-a.getWidth(),a.max_dx=r.getWidth()-a.getWidth()}var r=P.$bar,a=P.$bar_progress,o=P.group.select(".handle.progress");o&&o.drag(t,e,n)}function w(){var t=P.$bar;t.ox=t.getX(),t.oy=t.getY(),t.owidth=t.getWidth(),t.finaldx=0,E("onstart")}function x(t,n){var e=P.$bar;e.finaldx=I(t),T({x:e.ox+e.finaldx}),E("onmove",[t,n])}function C(){var t=P.$bar;t.finaldx&&(j(),W(),E("onstop"))}function k(t,n){var e=P.$bar;e.finaldx=I(t),T({x:e.ox+e.finaldx,width:e.owidth-e.finaldx}),E("onmove",[t,n])}function B(){var t=P.$bar;t.finaldx&&j(),W(),E("onstop")}function E(n,e){var r=t.dependency_map;if(r[P.task.id]){var a=!0,o=!1,i=void 0;try{for(var s,d=r[P.task.id][Symbol.iterator]();!(a=(s=d.next()).done);a=!0){var c=s.value,l=t.get_bar(c);l[n].apply(l,e)}}catch(f){o=!0,i=f}finally{try{!a&&d["return"]&&d["return"]()}finally{if(o)throw i}}}}function M(t,n){var e=P.$bar;e.finaldx=I(t),T({width:e.owidth+e.finaldx})}function $(){var t=P.$bar;t.finaldx&&j(),W()}function T(e){var r=e.x,a=void 0===r?null:r,o=e.width,i=void 0===o?null:o,s=P.$bar;if(a){var d=n.dependencies.map(function(n){return t.get_bar(n).$bar.getX()}),c=d.reduce(function(t,n){return a>=n},a);if(!c)return void(i=null);R(s,"x",a)}i&&i>=t.config.column_width&&R(s,"width",i),F(),X(),Y(),G(),z()}function D(){P.group.click(function(){P.action_completed||(P.group.hasClass("active")&&t.trigger_event("click",[P.task]),t.unselect_all(),P.group.toggleClass("active"))})}function j(){var n=H(),e=n.new_start_date,r=n.new_end_date;P.task._start=e,P.task._end=r,h(),t.trigger_event("date_change",[P.task,e,r])}function S(){var n=U();P.task.progress=n,h(),t.trigger_event("progress_change",[P.task,n])}function W(){P.action_completed=!0,setTimeout(function(){return P.action_completed=!1},2e3)}function H(){var n=P.$bar,e=n.getX()/t.config.column_width,r=t.gantt_start.clone().add(e*t.config.step,"hours"),a=n.getWidth()/t.config.column_width,o=r.clone().add(a*t.config.step,"hours");return o.add("-1","seconds"),{new_start_date:r,new_end_date:o}}function U(){var t=P.$bar_progress.getWidth()/P.$bar.getWidth()*100;return parseInt(t,10)}function L(){var n=P.task._start.diff(t.gantt_start,"hours")/t.config.step*t.config.column_width;return t.view_is("Month")&&(n=P.task._start.diff(t.gantt_start,"days")*t.config.column_width/30),n}function O(){return t.config.header_height+t.config.padding+P.task._index*(P.height+t.config.padding)}function I(n){var e=n,r=void 0,a=void 0;return t.view_is("Week")?(r=n%(t.config.column_width/7),a=e-r+(r<t.config.column_width/14?0:t.config.column_width/7)):t.view_is("Month")?(r=n%(t.config.column_width/30),a=e-r+(r<t.config.column_width/60?0:t.config.column_width/30)):(r=n%t.config.column_width,a=e-r+(r<t.config.column_width/2?0:t.config.column_width)),a}function R(t,n,e){return e=+e,isNaN(e)||t.attr(n,e),t}function Y(){P.$bar_progress.attr("x",P.$bar.getX()),P.$bar_progress.attr("width",P.$bar.getWidth()*(P.task.progress/100))}function F(){var t=P.$bar,n=P.group.select(".bar-label");n.getBBox().width>t.getWidth()?n.addClass("big").attr("x",t.getX()+t.getWidth()+5):n.removeClass("big").attr("x",t.getX()+t.getWidth()/2)}function X(){var t=P.$bar;P.handle_group.select(".handle.left").attr({x:t.getX()+1}),P.handle_group.select(".handle.right").attr({x:t.getEndX()-9});var n=P.group.select(".handle.progress");n&&n.attr("points",u())}function G(){var t=!0,n=!1,e=void 0;try{for(var r,a=P.arrows[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var o=r.value;o.update()}}catch(i){n=!0,e=i}finally{try{!t&&a["return"]&&a["return"]()}finally{if(n)throw e}}}function z(){var t=A(),n=t.x,e=t.y;P.details_box&&P.details_box.transform("t"+n+","+e)}function N(t){var n={};return t&&"[object Function]"===n.toString.call(t)}var P={};return P.onstart=w,P.onmove=x,P.onstop=C,P.onmove_handle_left=k,P.onstop_handle_left=B,e(),P}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=e,t.exports=n["default"]},function(t,n){"use strict";function e(t,n,e){function r(){s.from_task=n,s.to_task=e,a(),o()}function a(){s.start_x=n.$bar.getX()+n.$bar.getWidth()/2;for(var r=function(){return e.$bar.getX()<s.start_x+t.config.padding&&s.start_x>n.$bar.getX()+t.config.padding};r();)s.start_x-=10;s.start_y=t.config.header_height+t.config.bar.height+(t.config.padding+t.config.bar.height)*n.task._index+t.config.padding,s.end_x=e.$bar.getX()-t.config.padding/2,s.end_y=t.config.header_height+t.config.bar.height/2+(t.config.padding+t.config.bar.height)*e.task._index+t.config.padding;var a=n.task._index>e.task._index;s.curve=t.config.arrow.curve,s.clockwise=a?1:0,s.curve_y=a?-s.curve:s.curve,s.offset=a?s.end_y+t.config.arrow.curve:s.end_y-t.config.arrow.curve,s.path=Snap.format("M {start_x} {start_y} V {offset} a {curve} {curve} 0 0 {clockwise} {curve} {curve_y} L {end_x} {end_y} m -5 -5 l 5 5 l -5 5",{start_x:s.start_x,start_y:s.start_y,end_x:s.end_x,end_y:s.end_y,offset:s.offset,curve:s.curve,clockwise:s.clockwise,curve_y:s.curve_y}),e.$bar.getX()<n.$bar.getX()+t.config.padding&&(s.path=Snap.format("M {start_x} {start_y} v {down_1} a {curve} {curve} 0 0 1 -{curve} {curve} H {left} a {curve} {curve} 0 0 {clockwise} -{curve} {curve_y} V {down_2} a {curve} {curve} 0 0 {clockwise} {curve} {curve_y} L {end_x} {end_y} m -5 -5 l 5 5 l -5 5",{start_x:s.start_x,start_y:s.start_y,end_x:s.end_x,end_y:s.end_y,down_1:t.config.padding/2-s.curve,down_2:e.$bar.getY()+e.$bar.getHeight()/2-s.curve_y,left:e.$bar.getX()-t.config.padding,offset:s.offset,curve:s.curve,clockwise:s.clockwise,curve_y:s.curve_y}))}function o(){s.element=t.canvas.path(s.path).attr("data-from",s.from_task.task.id).attr("data-to",s.to_task.task.id)}function i(){a(),s.element.attr("d",s.path)}var s={};return s.update=i,r(),s}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=e,t.exports=n["default"]}])})}])});
//# sourceMappingURL=gantt.min.js.map